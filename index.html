  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Will You Be My Valentine?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #ff9a9e, #fecfef, #fbc2eb);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      color: #2d1023;
      overflow-x: hidden;
      overflow-y: auto;
      padding: 20px 0;
    }
    .card {
      background: rgba(255, 255, 255, 0.9);
      padding: 28px 24px 32px;
      border-radius: 24px;
      box-shadow: 0 18px 45px rgba(0,0,0,0.15);
      max-width: 500px;
      text-align: center;
      backdrop-filter: blur(10px);
      position: relative;
      z-index: 2;
    }
    .heart {
      font-size: 2.4rem;
      margin-bottom: 6px;
      animation: beat 1.1s infinite;
    }
    h1 {
      font-size: 2.1rem;
      margin-bottom: 6px;
    }
    h2 {
      font-size: 1rem;
      font-weight: 500;
      margin-top: 0;
      margin-bottom: 12px;
      color: #7a4a5f;
    }
    p {
      font-size: 0.98rem;
      line-height: 1.6;
      margin-bottom: 14px;
    }
    .gif-wrapper {
      margin: 10px auto 18px;
    }
    .gif-wrapper img {
      max-width: 100%;
      border-radius: 16px;
      box-shadow: 0 10px 24px rgba(0,0,0,0.15);
    }
    .gif-yes {
      display: none;
    }

    .buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: nowrap;
      margin-top: 10px;
      transition: flex-direction 0.15s ease;
    }
    .buttons.reverse {
      flex-direction: row-reverse;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
      white-space: nowrap;
      flex-shrink: 1;
    }
    .btn-yes {
      background: linear-gradient(135deg, #ff5f6d, #ffc371);
      color: white;
      box-shadow: 0 10px 20px rgba(255,95,109,0.4);
    }
    .btn-yes:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 26px rgba(255,95,109,0.5);
    }
    .btn-no {
      background: #ffe5f0;
      color: #c23b6f;
    }
    .btn-no:hover {
      background: #ffd6e8;
      transform: translateY(-1px);
    }

    .note {
      font-size: 0.8rem;
      margin-top: 16px;
      color: #a26b86;
      min-height: 1.2em;
    }

    /* Mobile "No" flow */
    .mobile-message {
      font-size: 0.9rem;
      color: #c23b6f;
      margin-top: 12px;
      font-weight: 500;
    }

    .confirm-input-wrapper {
      margin-top: 14px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .confirm-input-wrapper label {
      font-size: 0.9rem;
      color: #7a4a5f;
    }

    .confirm-input-wrapper input {
      border: 2px solid #fbc2eb;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 0.9rem;
      text-align: center;
      outline: none;
      width: 200px;
      font-family: inherit;
    }

    .confirm-input-wrapper input:focus {
      border-color: #ff5f6d;
    }

    .confirm-input-wrapper button {
      margin-top: 4px;
    }

    /* "No" sad screen GIF */
    .gif-no {
      display: none;
      margin: 0 auto;
    }

    /* Confetti */
    .confetti-piece {
      position: fixed;
      top: -10px;
      width: 8px;
      height: 14px;
      background: red;
      opacity: 0.9;
      border-radius: 2px;
      z-index: 999;
      animation: confetti-fall linear forwards;
      pointer-events: none;
    }

    @keyframes confetti-fall {
      0% {
        transform: translate3d(0, -10px, 0) rotateZ(0deg);
      }
      100% {
        transform: translate3d(0, 110vh, 0) rotateZ(360deg);
      }
    }

    @keyframes beat {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.08); }
      50% { transform: scale(0.96); }
      75% { transform: scale(1.05); }
    }

    /* Music toggle button */
    .music-toggle {
      position: fixed;
      bottom: 18px;
      right: 18px;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid #fbc2eb;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      font-size: 1.4rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      padding: 0;
    }
    .music-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }
    .music-toggle.muted {
      opacity: 0.6;
    }

    /* YouTube players - on-screen but invisible */
    .yt-players-container {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 200px;
      height: 200px;
      opacity: 0;
      pointer-events: none;
      z-index: -1;
    }

    /* Mobile styles */
    @media (max-width: 600px) {
      body {
        padding: 10px 0;
        align-items: flex-start;
        min-height: auto;
      }

      .card {
        max-width: 92%;
        padding: 20px 16px 24px;
        margin: 10px auto;
        box-sizing: border-box;
      }

      h1 {
        font-size: 1.6rem;
      }

      h2 {
        font-size: 0.9rem;
      }

      p {
        font-size: 0.88rem;
      }

      .buttons {
        flex-direction: column;
        gap: 10px;
        align-items: center;
      }

      button {
        font-size: 0.85rem;
        padding: 12px 16px;
        white-space: normal;
        width: 100%;
        box-sizing: border-box;
      }

      .gif-wrapper img {
        max-width: 100%;
      }

      .confirm-input-wrapper input {
        width: 80%;
        box-sizing: border-box;
      }

      .note {
        font-size: 0.8rem;
        word-wrap: break-word;
      }
    }
  </style>
</head>
<body>
  <!-- Music toggle button -->
  <button class="music-toggle" id="musicToggle" title="Toggle music">üéµ</button>

  <!-- Hidden YouTube players -->
  <div class="yt-players-container">
    <div id="ytPlayerInitial"></div>
    <div id="ytPlayerYes"></div>
    <div id="ytPlayerNo"></div>
  </div>

  <div class="card">
    <div class="heart">‚ù§Ô∏è</div>
    <h1 id="mainTitle">Will you be my Valentine?</h1>
    <h2 id="subTitle">To: Shoshone ¬∑ From: Andrew :)</h2>

    <p id="para1">
      While my way of asking isn't nearly as edible or delicious, I'm doing what I know best! Thank you for being amazing and putting up with me.
    </p>
    <p id="para2">
      So I made this just for you (with the help of AI). Would you like to investigate Valentine's Day with me?
    </p>

    <div class="gif-wrapper">
      <!-- Initial GIF (shown on load) -->
      <img
        class="gif-initial"
        src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExeXNkYWcxa3h6ZGkxN2gzeW51YmpubnNxazJ3bWd5ZDlkY2F5dXpyNiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/DUuyU3KyYGLNS/giphy.gif"
        alt="Cute love gif"
      />
      <!-- GIF shown after she clicks Yes -->
      <img
        class="gif-yes"
        src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExOTZkdnExeHI3NmExNzM5cDl2dXRqNXg3eG1tZjN6a2xpcWVibXVhcCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ki68qQ2Zh7CqDZines/giphy.gif"
        alt="Happy yes gif"
      />
      <!-- GIF shown if she confirms No -->
      <img
        class="gif-no"
        src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDJmcGVvanpuank2MXFvdWQ2cG1qOTRzYWx3MzM4ZWw3OHE3N3lxZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/BwP6IiUZZlpS0/giphy.gif"
        alt="Sad no gif"
      />
    </div>

    <div class="buttons" id="buttons">
      <button class="btn-yes" id="yesBtn">I would like to investigate it üíï</button>
      <button class="btn-no" id="noBtn">I would not like to investigate it üò¢</button>
    </div>

    <div class="note" id="note"></div>
  </div>

  <!-- YouTube IFrame API -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    var yesBtn = document.getElementById('yesBtn');
    var noBtn = document.getElementById('noBtn');
    var buttons = document.getElementById('buttons');
    var note = document.getElementById('note');
    var gifInitial = document.querySelector('.gif-initial');
    var gifYes = document.querySelector('.gif-yes');
    var gifNo = document.querySelector('.gif-no');

    var mainTitle = document.getElementById('mainTitle');
    var subTitle = document.getElementById('subTitle');
    var para1 = document.getElementById('para1');
    var para2 = document.getElementById('para2');
    var musicToggle = document.getElementById('musicToggle');

    // Detect touch device (mobile)
    var isMobile = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
    var mobileNoCount = 0;

    // ===== YOUTUBE MUSIC SYSTEM =====
    var players = { initial: null, yes: null, no: null };
    var playersReady = { initial: false, yes: false, no: false };
    var currentPlayer = null;
    var currentScreen = 'initial';
    var musicStarted = false;
    var musicMuted = false;
    var ytAPIReady = false;
    var pendingPlay = null; // track name to play once ready

    // YouTube video IDs
    var VIDEOS = {
      initial: '3pa5_EZZp7s', // Deal or No Deal
      yes: '3GwjfUFyY6M',     // Celebrate
      no: 'hBvJyi3fbtA'        // Boulevard of Broken Dreams
    };

    function createPlayer(name, elementId) {
      players[name] = new YT.Player(elementId, {
        height: '200',
        width: '200',
        videoId: VIDEOS[name],
        playerVars: {
          autoplay: (name === 'initial') ? 1 : 0,
          loop: 1,
          playlist: VIDEOS[name],
          controls: 0,
          disablekb: 1,
          fs: 0,
          modestbranding: 1,
          rel: 0,
          playsinline: 1
        },
        events: {
          'onReady': function() {
            playersReady[name] = true;
            players[name].setVolume(name === 'yes' ? 60 : 50);

            // Try to autoplay the initial track with sound immediately
            if (name === 'initial' && !musicStarted) {
              players[name].unMute();
              players[name].playVideo();
              currentPlayer = players[name];
              musicStarted = true;
              musicMuted = false;
              updateToggleIcon();
            }

            // If we were waiting to play this track, do it now
            if (pendingPlay === name) {
              pendingPlay = null;
              playTrack(name);
            }
          },
          'onError': function(e) {
            console.log('YT player error (' + name + '):', e.data);
          }
        }
      });
    }

    // Called automatically by the YouTube IFrame API when ready
    function onYouTubeIframeAPIReady() {
      ytAPIReady = true;
      createPlayer('initial', 'ytPlayerInitial');
      createPlayer('yes', 'ytPlayerYes');
      createPlayer('no', 'ytPlayerNo');
    }

    function stopAllPlayers() {
      ['initial', 'yes', 'no'].forEach(function(name) {
        try {
          if (players[name] && playersReady[name] && players[name].stopVideo) {
            players[name].pauseVideo();
          }
        } catch(e) {}
      });
      currentPlayer = null;
    }

    function playTrack(name) {
      var player = players[name];

      // If player isn't ready yet, queue it
      if (!player || !playersReady[name]) {
        pendingPlay = name;
        return;
      }

      stopAllPlayers();
      try {
        player.seekTo(0);
        player.playVideo();
        if (musicMuted) {
          player.mute();
        } else {
          player.unMute();
        }
        currentPlayer = player;
        musicStarted = true;
        updateToggleIcon();
      } catch(e) {
        console.log('playTrack error:', e);
      }
    }

    function updateToggleIcon() {
      musicToggle.textContent = musicMuted ? 'üîá' : 'üéµ';
      musicToggle.classList.toggle('muted', musicMuted);
    }

    function toggleMusic() {
      musicMuted = !musicMuted;
      if (currentPlayer) {
        try {
          if (musicMuted) {
            currentPlayer.mute();
          } else {
            currentPlayer.unMute();
          }
        } catch(e) {}
      }
      updateToggleIcon();
    }

    musicToggle.addEventListener('click', function(e) {
      e.stopPropagation();
      // If music hasn't started yet, start the current screen's track
      if (!musicStarted) {
        musicMuted = false;
        playTrack(currentScreen);
        return;
      }
      toggleMusic();
    });

    // Fallback: if browser blocked autoplay, first click/tap will start music
    var firstInteraction = false;
    function handleFirstInteraction() {
      if (firstInteraction) return;
      firstInteraction = true;
      // If autoplay worked, just make sure it's unmuted
      if (currentPlayer) {
        try {
          currentPlayer.unMute();
          currentPlayer.playVideo();
          musicMuted = false;
          updateToggleIcon();
        } catch(e) {}
      } else {
        musicMuted = false;
        playTrack(currentScreen);
      }
      document.removeEventListener('click', handleFirstInteraction);
      document.removeEventListener('touchstart', handleFirstInteraction);
    }
    document.addEventListener('click', handleFirstInteraction);
    document.addEventListener('touchstart', handleFirstInteraction);

    function launchConfetti() {
      var colors = [
        '#ff5f6d', '#ffc371', '#ff9a9e', '#fbc2eb', '#fad0c4', '#ffe5f0',
        '#ff6b9d', '#c44569', '#f8b500', '#ffd32a', '#ff6b6b', '#ee5a6f',
        '#4834d4', '#686de0', '#a29bfe', '#6c5ce7', '#00d2d3', '#54a0ff',
        '#5f27cd', '#341f97', '#00d2d3', '#01a3a4', '#ff6348', '#ff4757',
        '#ffa502', '#ff6348', '#ff7675', '#fd79a8', '#fdcb6e', '#e17055'
      ];
      var numPieces = 200;

      for (var i = 0; i < numPieces; i++) {
        var piece = document.createElement('div');
        piece.classList.add('confetti-piece');

        var size = Math.random() * 6 + 6;
        piece.style.width = size + 'px';
        piece.style.height = (size * 1.5) + 'px';

        piece.style.left = Math.random() * 100 + 'vw';
        piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

        var duration = Math.random() * 4 + 6;
        var delay = Math.random() * 2;
        var rotate = (Math.random() * 360) + 'deg';

        piece.style.animationDuration = duration + 's';
        piece.style.animationDelay = delay + 's';
        piece.style.transform = 'rotateZ(' + rotate + ')';

        document.body.appendChild(piece);

        (function(p, d) {
          setTimeout(function() { p.remove(); }, d * 1000);
        })(piece, duration + delay);
      }
    }

    function sayYes() {
      mainTitle.textContent = "She said YES! üíñ";
      para1.textContent = "WOOOOOOO!!!!! YEAH I THINK WE'D LIKE TO INVESTIGATE.";
      para2.textContent = "I can't wait to see you this weekend :) Menu still TBD";
      note.textContent = "Hearded Rivberly Gif next to the baby jesus what do you think about it?";

      if (gifInitial) gifInitial.style.display = 'none';
      if (gifYes) gifYes.style.display = 'block';
      if (gifNo) gifNo.style.display = 'none';

      buttons.style.display = 'none';
      // Remove confirm input if it exists
      var confirmWrapper = document.querySelector('.confirm-input-wrapper');
      if (confirmWrapper) confirmWrapper.remove();

      // Switch to celebration music (Celebrate)
      currentScreen = 'yes';
      playTrack('yes');

      launchConfetti();
    }

    function sayNo() {
      mainTitle.textContent = "FINEüñï";
      para1.textContent = "I guess I'll just eat two dinners by myself then!";
      para2.textContent = "YOUR LOSS";
      note.textContent = "";

      if (gifInitial) gifInitial.style.display = 'none';
      if (gifYes) gifYes.style.display = 'none';
      if (gifNo) gifNo.style.display = 'block';

      buttons.style.display = 'none';
      // Remove confirm input if it exists
      var confirmWrapper = document.querySelector('.confirm-input-wrapper');
      if (confirmWrapper) confirmWrapper.remove();

      // Switch to sad music (Boulevard of Broken Dreams)
      currentScreen = 'no';
      playTrack('no');
    }

    function showConfirmInput() {
      // Prevent duplicates ‚Äî if already showing, do nothing
      if (document.querySelector('.confirm-input-wrapper')) return;

      // Hide buttons
      buttons.style.display = 'none';

      // Show "must've been a misclick" message and keep it
      note.textContent = "Must've been a misclick... ü§®";
      note.style.color = '#c23b6f';
      note.style.fontSize = '0.9rem';

      // Create the input area
      var wrapper = document.createElement('div');
      wrapper.className = 'confirm-input-wrapper';

      var label = document.createElement('label');
      label.textContent = 'Type "yes" or "no" to confirm:';

      var input = document.createElement('input');
      input.type = 'text';
      input.placeholder = 'yes or no';
      input.autocomplete = 'off';
      input.autocapitalize = 'none';

      var submitBtn = document.createElement('button');
      submitBtn.className = 'btn-yes';
      submitBtn.textContent = 'Submit';

      submitBtn.addEventListener('click', function() {
        var answer = input.value.trim().toLowerCase();
        if (answer === 'yes') {
          sayYes();
        } else if (answer === 'no') {
          sayNo();
        } else {
          input.style.borderColor = '#ff5f6d';
          input.placeholder = 'Please type yes or no';
          input.value = '';
        }
      });

      // Also submit on Enter key
      input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          submitBtn.click();
        }
      });

      wrapper.appendChild(label);
      wrapper.appendChild(input);
      wrapper.appendChild(submitBtn);

      // Insert after buttons
      buttons.parentNode.insertBefore(wrapper, buttons.nextSibling);
    }

    // ===== DESKTOP: hover swap =====
    var hoverTimeout;
    function dodgeNo(event) {
      if (event) event.preventDefault();
      buttons.classList.toggle('reverse');
      // Show message
      note.textContent = "Woah don't think you meant to hover that one ü§®";
      note.style.color = '#c23b6f';
      note.style.fontSize = '0.9rem';
      // Clear any previous timeout
      clearTimeout(hoverTimeout);
      // Hide message after 2s
      hoverTimeout = setTimeout(function() {
        note.textContent = '';
        note.style.color = '';
        note.style.fontSize = '';
      }, 2000);
    }

    // ===== MOBILE: tap "No" escalation =====
    function handleMobileNo(event) {
      event.preventDefault();
      mobileNoCount++;

      if (mobileNoCount === 1) {
        // First tap: button jumps away, message appears
        noBtn.style.transform = 'translateX(-60px) translateY(-20px)';
        note.textContent = 'Are you sure you meant to click that? ü§î';
        note.style.color = '#c23b6f';
        note.style.fontSize = '0.9rem';

        // Reset after 1.5s
        setTimeout(function() {
          noBtn.style.transform = '';
          note.textContent = '';
          note.style.color = '';
          note.style.fontSize = '';
        }, 1500);

      } else if (mobileNoCount >= 2) {
        // Second tap: immediately show text input with message
        showConfirmInput();
      }
    }

    // Wire up events
    yesBtn.addEventListener('click', sayYes);

    if (isMobile) {
      // Mobile: tap escalation for "No"
      noBtn.addEventListener('click', handleMobileNo);
    } else {
      // Desktop: hover swap for "No"
      noBtn.addEventListener('mouseenter', dodgeNo);
      noBtn.addEventListener('click', dodgeNo);
    }
  </script>
</body>
</html>
